<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Path to Independence | MASTER CORE v5</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Rajdhani:wght@700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#05050a; --panel:#0d0d21; --text:#e9e9ff;
  --accent:#00ff99; --secondary:#22d3ee; --danger:#ff0055;
  --font-pix:'Press Start 2P', cursive;
}

html,body{
  margin:0; padding:0; width:100vw; height:100vh;
  background:var(--bg); color:var(--text);
  font-family:'Rajdhani',sans-serif;
  overflow:hidden;
}

/* ---------- ARENA ---------- */
.arena{
  height:38vh;
  position:relative;
  background:radial-gradient(circle,#1a1a3a 0%,#000 100%);
  border-bottom:2px solid var(--accent);
  display:flex;
  align-items:center;
  justify-content:center;
}

/* Jail Bars */
.jail-bars{
  position:absolute; inset:0;
  background:repeating-linear-gradient(90deg,transparent,transparent 18%,#111 18%,#222 21%);
  z-index:10;
  transition:1.2s;
}

/* Hero */
.hero-container{
  position:relative;
  width:100px; height:100px;
  z-index:5;
}
.main-sprite{
  font-size:70px;
  text-align:center;
  filter:drop-shadow(0 0 10px var(--accent));
}
.hero-equip{
  position:absolute;
  font-size:35px;
  opacity:0;
  transition:.3s;
}
.hero-equip.visible{ opacity:1; }

/* Hero UI FIX ‚Äî name LOWERED */
.hero-ui{
  position:absolute;
  top:14%;
  left:12px;
  background:rgba(0,0,0,.45);
  padding:6px 8px;
  border-radius:6px;
  font-family:var(--font-pix);
  font-size:7px;
  z-index:30;
}

/* ---------- DASHBOARD ---------- */
.dashboard{
  height:62vh;
  display:flex;
  flex-direction:column;
  padding:10px;
}

.nav-tabs{
  display:flex; gap:4px;
}
.tab-btn{
  flex:1;
  padding:8px;
  background:#111;
  border:1px solid #333;
  font-family:var(--font-pix);
  font-size:7px;
  color:#666;
  cursor:pointer;
}
.tab-btn.active{
  background:var(--accent);
  color:#000;
  border-color:var(--accent);
}

/* Panels */
.panel-content{ flex:1; overflow-y:auto; }
.panel{ padding:10px; }
.hidden{ display:none !important; }

/* Quest UI */
.quest-box{
  border:1px solid #333;
  padding:10px;
  border-radius:6px;
  margin-bottom:8px;
  background:rgba(255,255,255,.02);
}
.quest-complete{
  animation:fadeSlide .6s forwards;
}
@keyframes fadeSlide{
  0%{opacity:1; transform:translateY(0)}
  100%{opacity:0; transform:translateY(-10px)}
}

/* Progress */
.footer-stats{
  border-top:1px solid #333;
  padding-top:6px;
}
.bar-bg{
  height:10px;
  background:#000;
  border-radius:5px;
  overflow:hidden;
}
.bar-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--accent),var(--secondary));
  transition:1s;
}

/* Intro / Story Overlay */
#storyOverlay{
  position:fixed;
  inset:0;
  background:#000;
  z-index:5000;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-family:var(--font-pix);
  font-size:10px;
  animation:fadeOut 6s forwards;
}
@keyframes fadeOut{
  0%,60%{opacity:1}
  100%{opacity:0; pointer-events:none}
}
</style>
</head>

<body>

<!-- STORY OPEN -->
<div id="storyOverlay">
  <div>
    <p>Freedom is earned.</p>
  </div>
</div>

<div class="arena">
  <div class="jail-bars" id="jail"></div>

  <div class="hero-container">
    <div class="main-sprite" id="heroSprite">üë§</div>
    <div class="hero-equip" id="heroWeapon" style="right:-20px; top:25px;">‚öîÔ∏è</div>
  </div>

  <div class="hero-ui">
    <div id="heroName">HERO</div>
    <div style="color:var(--danger)">ACT 1: PRISONER</div>
  </div>
</div>

<div class="dashboard">

  <div class="nav-tabs">
    <button class="tab-btn active" onclick="showTab('quests',this)">QUESTS</button>
    <button class="tab-btn" onclick="showTab('contract',this)">VOW</button>
    <button class="tab-btn" onclick="showTab('config',this)">CONFIG</button>
  </div>

  <div class="panel-content">

    <!-- QUESTS -->
    <div id="quests" class="panel">
      <div class="quest-box" id="quest1">
        <div style="font-family:var(--font-pix);font-size:7px;color:var(--secondary)">ACT 1 ‚Äì ESCAPE CELL</div>
        <label><input type="checkbox" onchange="completeQuest(1)"> Interact with cell door</label>
      </div>

      <div class="quest-box hidden" id="quest2">
        <div style="font-family:var(--font-pix);font-size:7px;color:var(--secondary)">HALLWAY COMBAT</div>
        <label><input type="checkbox" onchange="completeQuest(2)"> Defeat guards</label>
      </div>
    </div>

    <!-- CONTRACT -->
    <div id="contract" class="panel hidden">
      <input type="file" onchange="loadContract(event)">
      <pre id="contractText">Upload contract...</pre>
    </div>

    <!-- CONFIG -->
    <div id="config" class="panel hidden">
      <select onchange="changeBGM(this.value)">
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-17.mp3">CYBER</option>
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">LOFI</option>
      </select>
    </div>

  </div>

  <div class="footer-stats">
    <div style="display:flex;justify-content:space-between;font-family:var(--font-pix);font-size:7px;">
      <span>PROGRESS</span><span id="xpText">0%</span>
    </div>
    <div class="bar-bg"><div id="xpBar" class="bar-fill"></div></div>
  </div>

</div>

<script>
/* ---------- AUDIO AUTOPLAY FIX ---------- */
let audioUnlocked=false;
let bgm=new Audio("https://www.soundhelix.com/examples/mp3/SoundHelix-Song-17.mp3");
bgm.loop=true; bgm.volume=.4;

function unlockAudio(){
  if(audioUnlocked) return;
  bgm.play();
  audioUnlocked=true;
}

/* ---------- QUEST SYSTEM ---------- */
let progress=0;

function completeQuest(id){
  unlockAudio();

  const q=document.getElementById("quest"+id);
  q.classList.add("quest-complete");

  setTimeout(()=>{
    q.classList.add("hidden");
    progress+=50;
    updateXP();

    if(id===1){
      document.getElementById("quest2").classList.remove("hidden");
      document.getElementById("jail").style.opacity=".4";
      document.getElementById("heroWeapon").classList.add("visible");
    }

    if(id===2){
      document.getElementById("jail").style.display="none";
      alert("ACT 1 COMPLETE\nYou didn‚Äôt survive. You overcame.");
    }
  },600);
}

function updateXP(){
  document.getElementById("xpBar").style.width=progress+"%";
  document.getElementById("xpText").innerText=progress+"%";
}

/* ---------- UI ---------- */
function showTab(id,btn){
  unlockAudio();
  document.querySelectorAll(".panel").forEach(p=>p.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

/* ---------- CONTRACT ---------- */
function loadContract(e){
  const r=new FileReader();
  r.onload=()=>document.getElementById("contractText").innerText=r.result;
  r.readAsText(e.target.files[0]);
}

/* ---------- MUSIC ---------- */
function changeBGM(src){
  unlockAudio();
  bgm.pause();
  bgm=new Audio(src);
  bgm.loop=true;
  bgm.volume=.4;
  bgm.play();
}
</script>

</body>
</html>
